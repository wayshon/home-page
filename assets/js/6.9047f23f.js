(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{174:function(t,e,a){t.exports=a.p+"assets/img/1.b4247d2a.jpeg"},198:function(t,e,a){"use strict";a.r(e);var i=[function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"ios-app内页面添加到桌面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ios-app内页面添加到桌面","aria-hidden":"true"}},[this._v("#")]),this._v(" ios app内页面添加到桌面")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("2019-04-18")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#原理","aria-hidden":"true"}},[this._v("#")]),this._v(" 原理")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[t._v("准备好一个html页面，配置icon等等，并加上 "),a("code",[t._v('window.location.href="weixin://xxxx"')]),t._v("(这里以微信为例，xxx代表需要传的参数)，具体schema跳转的规则可查阅相关文档，这里不累述")]),t._v(" "),a("li",[t._v("iOS 里 "),a("code",[t._v('[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http//:xxxx"]];')]),t._v(" 这里的 xxxx 是第一步准备好的html页面")]),t._v(" "),a("li",[t._v("html 里引导用户将当前网页添加至桌面")]),t._v(" "),a("li",[t._v("用户点击新添加的标签就可以通过 schema 唤起 app 了")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"上述方法存在的问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#上述方法存在的问题","aria-hidden":"true"}},[this._v("#")]),this._v(" 上述方法存在的问题")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("app 唤起 safari 打开这个地址时就会弹出提示 "),e("code",[this._v("在 xx 中打开链接吗")]),this._v(" 的系统弹窗提示。")]),this._v(" "),e("li",[this._v("每次打开桌面上的标签就会弹出同样的提示")]),this._v(" "),e("li",[e("img",{attrs:{src:a(174),alt:""}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"需求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#需求","aria-hidden":"true"}},[this._v("#")]),this._v(" 需求")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("app 打开 Safari 时不尝试唤起app")]),this._v(" "),e("li",[this._v("从桌面标签点开始直接唤起app，不弹出提示弹窗")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"解决方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决方案","aria-hidden":"true"}},[this._v("#")]),this._v(" 解决方案")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"app-打开-safari-时不尝试唤起app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#app-打开-safari-时不尝试唤起app","aria-hidden":"true"}},[this._v("#")]),this._v(" app 打开 Safari 时不尝试唤起app")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[t._v("给 html 加上 "),a("code",[t._v('<meta name="apple-mobile-web-app-capable" content="yes">')]),t._v(" 要求全屏显示")]),t._v(" "),a("li",[t._v("schema 跳转时加上 "),a("code",[t._v("if(window.navigator.standalone)")]),t._v(" 判断是否全屏模式")]),t._v(" "),a("li",[t._v("因为app唤起safari打开时肯定不是全屏的，所以不会走进唤起schema的逻辑，而添加到桌面后打开则是全屏模式，就会走schema唤起app")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"schema-唤起-app-不显示确认弹窗"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#schema-唤起-app-不显示确认弹窗","aria-hidden":"true"}},[this._v("#")]),this._v(" schema 唤起 app 不显示确认弹窗")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"ios-12-2-新问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ios-12-2-新问题","aria-hidden":"true"}},[this._v("#")]),this._v(" iOS 12.2 新问题")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("以上操作在12.2以前都是ok的，但是12.2从桌面打开，响应的js并不会执行一遍，也就是那段js逻辑根本没有执行，即使监听 "),e("code",[this._v("onpageshow")]),this._v("事件也不会执行")]),this._v(" "),e("li",[this._v("然后观摩了支付宝添加小程序到桌面的sao操作，直接是把html搞成base64 string 在Safari打开，用这个方式打开的页面保存桌面后，每次打开都会执行")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"最后，贴代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#最后，贴代码","aria-hidden":"true"}},[this._v("#")]),this._v(" 最后，贴代码")])}],s=a(0),r=Object(s.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),a("p",[a("big",{staticStyle:{color:"red"}},[a("strong",[t._v("However 真要是这么简单我就不写这篇博了")])])],1),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),a("ul",[a("li",[t._v("如果您按上面的流程走完了，会发现这时候从桌面打开标签会直接唤起app，没有弹出确认弹窗")]),t._v(" "),a("li",[t._v("对于这个偶然的发现，也是不知道究竟是什么原理。猜测有下原因：\n"),a("ul",[a("li",[t._v("meta 标签导致添加到桌面后，iOS默认是以pwa的模式打开了这个页面")]),t._v(" "),a("li",[t._v("独立的PWA仍由奇怪的Web.app进程及其兄弟WebApp1.app提供支持。这意味着它不是100％Safari或SFViewController。"),a("a",{attrs:{href:"https://medium.com/@firt/pwas-on-ios-12-2-beta-the-good-the-bad-and-the-not-sure-yet-if-good-a37b6fa6afbf",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文章"),a("OutboundLink")],1)])])])]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),a("p",[t._v("懒得帖了，去github看吧: "),a("a",{attrs:{href:"https://github.com/wayshon/schema-ios",target:"_blank",rel:"noopener noreferrer"}},[t._v("github地址"),a("OutboundLink")],1)])])},i,!1,null,null,null);e.default=r.exports}}]);